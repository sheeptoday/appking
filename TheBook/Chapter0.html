<!doctype html><!-- appart :: 8002 :: 2019.8.13 -->
<html lang="ru">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <!-- ========================================= HEAD CONTENT -->


    <title>Король Апп. Глава 3.</title>
    <meta name="description" content="История сайта, расказанная его компонентами" />
    <meta name="author"      content="zl 2019, www.sheep.today" />


    <!-- ========================================= BOOT -->


    <style>
        /* ༼°▽°༽ style boot */
        body    { width: 100%; height: auto; overflow: hidden; }
        img,svg { max-width: 100%; }
    </style>


    <script>
        /* ༼°▽°༽ app boot */
        function BootKing() {
            let  King = this
            King.has  =  {
                 Queens: ['mutate','onload'],
                 Memory: [],
                 toRemember: (something) => King.has.Memory.push(something) }
            function KeepInMemory(responsible) {
                 return (dna) => King.has.toRemember({dna,for:responsible}) }
            King.has.Queens.map( (queen)=>King[queen]=KeepInMemory(queen) ) }

        let app = new BootKing()
    </script>


    <!-- ༼°▽°༽ prefetch boot -->
    <link rel="preconnect"   href="//fonts.gstatic.com">
    <!-- INFO: https://3perf.com/blog/link-rels/ -->


    <!-- ========================================= DESIGN -->


    <link
        href="app/styles/appart.css?v2019.8.12"
        rel="stylesheet" type="text/css">
    <link
        href="https://fonts.googleapis.com/css?family=Vollkorn:400,400i,700&subset=cyrillic"
        rel="stylesheet">


    <!-- FAVICON -->
    <!-- 2019.1, best favicon service: https://realfavicongenerator.net/ -->
    <link rel="apple-touch-icon" sizes="180x180" href="app/favicons/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="app/favicons/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="app/favicons/favicon-16x16.png">
    <link rel="manifest" href="app/favicons/site.webmanifest">
    <link rel="mask-icon" href="app/favicons/safari-pinned-tab.svg" color="#5bbad5">
    <link rel="shortcut icon" href="app/favicons/favicon.ico">
    <meta name="msapplication-TileColor" content="#ffc40d">
    <meta name="msapplication-config" content="app/favicons/browserconfig.xml">
    <meta name="theme-color" content="#ffffff">


    <!-- ========================================= APP CUSTOM -->

    <link
        href="app/styles/el-chapters.css?v2019.8.13.opacity"
        rel="stylesheet" type="text/css">


    <!-- ========================================== ʕ⊙ᴥ⊙ʔ = -->
    <!-- ========================================= END HEAD -->
</head>
<body class="colors--ivory use-colors">


    <!-- ------------------------------------------- Знакомство -->


    <article id="BattleSheeps" class="chapter article-grid">

        <header class="article-header">
            <h2 class="big-title">«Почему мы начинаем с конца?»</h2>
        </header>

        <p>Спросила у короля девушка по имени Константа.</p>

        <p>Вдвоём, они сидели на черепичной крыше двухэтажного дома — гостиницы, стоявшей на краю небольшого посёлка.</p>

        <p>С одной стороны, гостиницу окружала каштановая роща — мать теней, как её называли местные жители. На тропинках под кроной деревьев вразброс лежали древние монументы, отчасти покалеченные временем, но от этого выглядели магическими камнями. Каждая прогулка по каштановой роще превращалась в поиски интересных надписей и рисунков на монументах.</p>

        <p>По другую сторону гостиницы... Вот здесь будет удобнее перечислить списком, начиная издалека:</p>

        <ul>
            <li>Горная гряда ломаной линией опоясывала горизонт.</li>
            <li>Черепичные крыши сельских домов устилали вид ярко оранжевым ковром, на котором сидели дети с интересом наблюдая за происходящим, —</li>
            <li>Толпа местных жителей и гостей посёлка стояла перед гостиницей. Вооружённые палками и готовые в любой момент пойти на штурм. Гневные крики в адрес короля не были громкими, скорее напоминали недовольный ропот. Если прислушаться, чтобы понять чем вызвано недовольство, можно услышать слова «оптимизация», «ужать», «уменьшить». Более подробно, намерение толпы выражал плакат, со схематично нарисованной головой короля на одной стороне и остальной частью короля на противоположной.</li>
            <li>Гостиничный двор окружал невысокий деревянный забор, но не он удерживал толпу от решительных действий.</li>
            <li>Пол сотни овечек в бронзовых доспехах — преданная гвардия короля Аппа — ровными рядами стояли перед забором. Это были настоящие овечки, если не считать доспехи и теоретическую возможность, по первому приказу, разнести всех собравшихся людей по домам. Эти же овечки умели танцевать хороводы в мирное время и готовить еду на кострах. Такая вот сказочка.</li>
        </ul>

    </article>

    <!-- -------------------------------------------------------------- -->

    <!-- Содержание -->

    <aside class="ChaptersBar offsidebar from-eastside colors-as-secondary">
        <section class="sidepanel">

            <header class="sidepanel-header">
                <h2 class="min-title">Глава 0.</h2>
            </header>

            <nav class="sidepanel-content">
                <ul class="asidebar-list js-for-ChaptersBar">
                    <li></li>
                </ul>
            </nav>

            <footer class="sidepanel-footer">
                <div><a href="index.html">Начало</a></div>
            </footer>

        </section>
    </aside>
    <button class="VonHamburgerOnDuty">
        <figure class="el-hamburger js-for-ChaptersBar">
            <img class="for-inactive" src="art/characters/hamburger.svg" alt="Барон фон Гамбургер">
            <div class="for-active svga-icon base-size"><svg><use xlink:href="#svg-close"></use></svg></div>
        </figure>
    </button>

    <!-- ActivateChaptersBar -->

    <script>
        function InterfaceOffsideBar (barName) {

            const asidebar = document.querySelector('.'+barName)
            const htmlwrap = document.querySelector('html')

            const classActive     = 'is-active'
            const classHasOverlay = 'has-offsidebar-overlay'
            const cssBartender    ='.js-for-' + barName
            const classOverlay    = 'offsidebar-overlay'
            const classBackground = 'offsidebar-background'

            const doClose  = () => {
                asidebar.classList.remove(classActive)
                htmlwrap.classList.remove(classHasOverlay) }
            const doOpen   = () => {
                asidebar.classList.add(classActive)
                htmlwrap.classList.add(classHasOverlay) }
            const doToggle = () => {
                if (asidebar.classList.contains(classActive)) doClose()
                else doOpen()
            }

            // find and activate bartenders
            const bartenderFunction = (el, order) =>
                  el.addEventListener('click', order === 'close' ? doClose : doToggle )
            document.querySelectorAll(cssBartender).forEach(bartenderFunction)

            // find/create background
            let background = asidebar.querySelector('.'+classBackground)
            if(!background) {
                background = document.createElement('div')
                background.classList.add(classBackground)
                asidebar.prepend(background)
            }

            // find/create shadow overlay with functionality
            let overlay = asidebar.querySelector('.'+classOverlay)
            if(!overlay) {
                overlay = document.createElement('div')
                overlay.classList.add(classOverlay)
                asidebar.prepend(overlay)
            }
            bartenderFunction(overlay, 'close')
        }

        // Launch Activation
        InterfaceOffsideBar('ChaptersBar')
    </script>

    <!-- Activate von Hamburger position -->

    <script>
        function vonHamburgerIsActiveWhenGoesNorth (markerName) {
            const marker    = document.querySelector('.el-introduction .el-hamburger')
            const dutyPlace = document.querySelector('.VonHamburgerOnDuty')
            const doDisplay = () => dutyPlace.classList.add('is-active')
            const doAway    = () => dutyPlace.classList.remove('is-active')

            if( !window.IntersectionObserver ) return doDisplay()

            const markerFunction = (reports) => {
                let status = reports[0]
                if (status.boundingClientRect.bottom>0) doAway()
                else doDisplay()
            }
            const markerObserver = new IntersectionObserver(markerFunction, {threshold:[0]} )
            markerObserver.observe(marker)
        }
        vonHamburgerIsActiveWhenGoesNorth()
    </script>

</body>
</html>
